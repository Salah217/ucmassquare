{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}UCMAS{% endblock %}</title>

    <link rel="stylesheet" href="{% static 'tabler/css/tabler.min.css' %}">
    <link rel="stylesheet" href="{% static 'tabler/css/tabler-vendors.min.css' %}">
  </head>

  <body>
    <div class="page">

      <!-- Sidebar -->
      <aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
        <div class="container-fluid">

          <h1 class="navbar-brand navbar-brand-autodark">
            <a href="{% url 'portal_dashboard' %}">
              UCMAS KSA
            </a>
          </h1>

          <div class="navbar-nav flex-row d-lg-none">
            <a class="nav-link" data-bs-toggle="collapse" data-bs-target="#sidebar-menu" aria-expanded="false">
              Menu
            </a>
          </div>

          <div class="collapse navbar-collapse" id="sidebar-menu">
            <ul class="navbar-nav pt-lg-3">

              <li class="nav-item">
                <a class="nav-link" href="{% url 'portal_dashboard' %}">
                  <span class="nav-link-title">Dashboard</span>
                </a>
              </li>

              <li class="nav-item">
                <a class="nav-link" href="{% url 'portal_student_list' %}">
                  <span class="nav-link-title">Students</span>
                </a>
              </li>
              {% if request.user.role == "ORG_MANAGER" %}
              <li class="nav-item">
                <a class="nav-link" href="{% url 'portal_submit' %}">
                  <span class="nav-link-title">Submit</span>
                </a>
              </li>
              {% endif %}
              <li class="nav-item">
                <a class="nav-link" href="{% url 'portal_student_add' %}">
                  <span class="nav-link-title">Add Student</span>
                </a>
              </li>

              <li class="nav-item mt-3">
               <form method="post" action="{% url 'portal_logout' %}">
                    {% csrf_token %}
                 <button type="submit" class="nav-link text-danger btn btn-link p-0 w-100 text-start">
                   <span class="nav-link-title">Logout</span>
                 </button>
               </form>
              </li>
            </ul>
          </div>

        </div>
      </aside>

      <!-- Main -->
      <div class="page-wrapper">

        <!-- Topbar -->
        <header class="navbar navbar-expand-md navbar-light d-none d-lg-flex">
          <div class="container-xl">
            <div class="navbar-nav flex-row order-md-last">
              <div class="nav-item dropdown">
                <a href="#" class="nav-link d-flex lh-1 text-reset p-0" data-bs-toggle="dropdown" aria-label="Open user menu">
                  <div class="d-none d-xl-block ps-2">
                    <div>{{ request.user.username }}</div>
                    <div class="mt-1 small text-muted">
                      {{ request.user.get_role_display }}
                      {% if request.user.organization %} Â· {{ request.user.organization.name_en }}{% endif %}
                    </div>
                  </div>
                </a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                  <form method="post" action="{% url 'portal_logout' %}" class="px-2 py-1">
                    {% csrf_token %}
                     <button type="submit" class="dropdown-item">Logout</button>
                  </form>
                </div>
              </div>
            </div>

            <div class="navbar-nav">
              <div class="nav-item">
                <span class="nav-link disabled">
                  School / Association Portal
                </span>
              </div>
            </div>
          </div>
        </header>

        <!-- Page Content -->
        <div class="page-body">
          <div class="container-xl">
            {% if messages %}
              {% for message in messages %}
                <div class="alert alert-{{ message.tags }} mt-3">{{ message }}</div>
              {% endfor %}
            {% endif %}

            {% block content %}{% endblock %}
          </div>
        </div>

        <footer class="footer footer-transparent d-print-none">
          <div class="container-xl">
            <div class="text-center text-muted py-2">
              UCMAS KSA Portal
            </div>
          </div>
        </footer>

      </div>
    </div>

    <script src="{% static 'tabler/js/tabler.min.js' %}"></script>
  </body>
</html>
